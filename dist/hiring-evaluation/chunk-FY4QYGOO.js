import{a as j}from"./chunk-PJRJ33IU.js";import{b as I,c as r,d as _,e as F,g as N,h as x,i as w,l as O,m as R,n as A,o as D,p as M,q as G,r as H,t as Q}from"./chunk-46GCKG2T.js";import{b as C,d as k}from"./chunk-AHEKFUMX.js";import{Da as S,Ha as p,Oa as s,Qb as b,Ra as i,Rb as h,Sa as e,Ta as d,Xa as g,Yb as T,c as f,db as n,dc as E,eb as y,ua as l,ya as u}from"./chunk-BULBJQPZ.js";function V(o,t){o&1&&(i(0,"div",32),n(1,"Required"),e())}function B(o,t){o&1&&(i(0,"div",32),n(1,"Enter valid minutes"),e())}function P(o,t){o&1&&(i(0,"div",32),n(1,"1-5"),e())}function U(o,t){o&1&&(i(0,"div",32),n(1,"1-5"),e())}function K(o,t){o&1&&(i(0,"div",32),n(1,"1-5"),e())}function W(o,t){if(o&1&&(i(0,"option",33),n(1),e()),o&2){let m=t.$implicit;s("value",m.value),l(),y(m.label)}}function Y(o,t){o&1&&(i(0,"span"),n(1,"Save System Task Evaluation"),e())}function $(o,t){o&1&&d(0,"span",34)}var q=class o{constructor(t,m,a,v,c){this.fb=t;this.route=m;this.fs=a;this.toast=v;this.router=c}form;candidateId="";submitting=!1;candidate;recommendationOptions=[{value:"strong-hire",label:"Strong Hire"},{value:"hire",label:"Hire"},{value:"no-hire",label:"No Hire"},{value:"strong-no-hire",label:"Strong No Hire"}];ngOnInit(){return f(this,null,function*(){this.candidateId=this.route.snapshot.paramMap.get("candidateId")||"",this.form=this.fb.group({taskType:["design",r.required],completionTime:[60,[r.required,r.min(1)]],codeQuality:[5,[r.required,r.min(1),r.max(5)]],problemSolvingAbility:[5,[r.required,r.min(1),r.max(5)]],creativity:[5,[r.required,r.min(1),r.max(5)]],testCases:[0,[r.min(0)]],taskDescription:[""],strengths:[""],weaknesses:[""],recommendation:["hire",r.required]}),this.candidateId&&(this.candidate=yield this.fs.getCandidateById(this.candidateId),this.candidate||(this.toast.error("Candidate not found"),this.router.navigate(["/candidates"])))})}get f(){return this.form.controls}save(){return f(this,null,function*(){if(this.form.invalid){this.form.markAllAsTouched();return}this.submitting=!0;try{let t=this.form.value,m=(t.strengths||"").split(/\n|,/).map(c=>c.trim()).filter(c=>!!c),a=(t.weaknesses||"").split(/\n|,/).map(c=>c.trim()).filter(c=>!!c),v={candidateId:this.candidateId,candidateName:this.candidate?.name||"Candidate",position:this.candidate?.position||"Unknown",stage:"system-task",interviewerId:this.fs.currentUserSubject.value?.id||"unknown",interviewerName:this.fs.currentUserSubject.value?.name||"Unknown",isCompleted:!0,overallRating:this.calculateOverall(t),recommendation:t.recommendation,comments:t.taskDescription||"",strengths:m,areasForImprovement:a,systemTask:{taskType:t.taskType,taskDescription:t.taskDescription||"",completionTime:t.completionTime,codeQuality:t.codeQuality,problemSolvingApproach:t.problemSolvingAbility,creativity:t.creativity,testCases:t.testCases,totalTestCases:t.testCases}};yield this.fs.createEvaluation(v),this.toast.success("System task evaluation saved"),this.router.navigate(["/evaluation/technical",this.candidateId])}catch(t){this.toast.error(t.message||"Failed to save")}this.submitting=!1})}calculateOverall(t){let m=[t.codeQuality||0,t.problemSolvingAbility||0,t.creativity||0];return+(m.reduce((a,v)=>a+v,0)/m.length).toFixed(2)}static \u0275fac=function(m){return new(m||o)(u(H),u(C),u(E),u(j),u(k))};static \u0275cmp=S({type:o,selectors:[["app-system-task-form"]],decls:69,vars:11,consts:[[1,"container","py-4","system-task-wrapper"],[1,"mb-3"],[1,"card","p-4","shadow-sm",3,"ngSubmit","formGroup"],[1,"row","g-3"],[1,"col-md-4"],[1,"form-label"],["formControlName","taskType",1,"form-select"],["value","coding"],["value","case-study"],["value","design"],["value","other"],["class","invalid-feedback d-block",4,"ngIf"],["type","number","formControlName","completionTime",1,"form-control"],["type","number","min","1","max","5","formControlName","codeQuality",1,"form-control"],["type","number","min","1","max","5","formControlName","problemSolvingAbility",1,"form-control"],["type","number","min","1","max","5","formControlName","creativity",1,"form-control"],["type","number","formControlName","testCases",1,"form-control"],[1,"col-12"],["rows","3","formControlName","taskDescription",1,"form-control"],[1,"col-md-6"],["rows","3","formControlName","strengths","placeholder","Fast learner, Good architecture vision",1,"form-control"],["rows","3","formControlName","weaknesses","placeholder","Needs test coverage focus",1,"form-control"],["formControlName","recommendation",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-4","d-flex","align-items-end"],[1,"p-2","bg-light","rounded","small","w-100"],[1,"text-muted","small"],[1,"fw-semibold"],[1,"mt-4"],[1,"btn","btn-primary",3,"disabled"],[4,"ngIf"],["class","spinner-border spinner-border-sm",4,"ngIf"],[1,"invalid-feedback","d-block"],[3,"value"],[1,"spinner-border","spinner-border-sm"]],template:function(m,a){m&1&&(i(0,"div",0)(1,"h4",1),n(2,"System Task Feedback"),e(),i(3,"form",2),g("ngSubmit",function(){return a.save()}),i(4,"div",3)(5,"div",4)(6,"label",5),n(7,"Task Type"),e(),i(8,"select",6)(9,"option",7),n(10,"Coding"),e(),i(11,"option",8),n(12,"Case Study"),e(),i(13,"option",9),n(14,"Design"),e(),i(15,"option",10),n(16,"Other"),e()(),p(17,V,2,0,"div",11),e(),i(18,"div",4)(19,"label",5),n(20,"Completion Time (min)"),e(),d(21,"input",12),p(22,B,2,0,"div",11),e(),i(23,"div",4)(24,"label",5),n(25,"Code Quality (1-5)"),e(),d(26,"input",13),p(27,P,2,0,"div",11),e(),i(28,"div",4)(29,"label",5),n(30,"Problem Solving (1-5)"),e(),d(31,"input",14),p(32,U,2,0,"div",11),e(),i(33,"div",4)(34,"label",5),n(35,"Creativity (1-5)"),e(),d(36,"input",15),p(37,K,2,0,"div",11),e(),i(38,"div",4)(39,"label",5),n(40,"Test Cases Passed"),e(),d(41,"input",16),e(),i(42,"div",17)(43,"label",5),n(44,"Task Description / Notes"),e(),d(45,"textarea",18),e(),i(46,"div",19)(47,"label",5),n(48,"Strengths (comma or newline separated)"),e(),d(49,"textarea",20),e(),i(50,"div",19)(51,"label",5),n(52,"Weaknesses (comma or newline separated)"),e(),d(53,"textarea",21),e(),i(54,"div",4)(55,"label",5),n(56,"Recommendation"),e(),i(57,"select",22),p(58,W,2,2,"option",23),e()(),i(59,"div",24)(60,"div",25)(61,"div",26),n(62,"Overall"),e(),i(63,"div",27),n(64),e()()()(),i(65,"div",28)(66,"button",29),p(67,Y,2,0,"span",30)(68,$,1,0,"span",31),e()()()()),m&2&&(l(3),s("formGroup",a.form),l(14),s("ngIf",a.f.taskType.touched&&a.f.taskType.invalid),l(5),s("ngIf",a.f.completionTime.touched&&a.f.completionTime.invalid),l(5),s("ngIf",a.f.codeQuality.touched&&a.f.codeQuality.invalid),l(5),s("ngIf",a.f.problemSolvingAbility.touched&&a.f.problemSolvingAbility.invalid),l(5),s("ngIf",a.f.creativity.touched&&a.f.creativity.invalid),l(21),s("ngForOf",a.recommendationOptions),l(6),y(a.calculateOverall(a.form.value)||0),l(2),s("disabled",a.form.invalid||a.submitting),l(),s("ngIf",!a.submitting),l(),s("ngIf",a.submitting))},dependencies:[T,b,h,Q,N,A,D,I,x,R,_,F,G,M,w,O],styles:[".system-task-wrapper[_ngcontent-%COMP%]{max-width:1000px}"]})};export{q as SystemTaskFormComponent};
