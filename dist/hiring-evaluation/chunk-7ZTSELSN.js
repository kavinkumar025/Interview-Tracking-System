import{a as U}from"./chunk-PJRJ33IU.js";import{b as H,d as G,f as J,m as K,n as Y,o as $,s as Q}from"./chunk-46GCKG2T.js";import{d as q}from"./chunk-AHEKFUMX.js";import{Da as w,Ha as m,Oa as l,Pb as B,Qb as F,Ra as a,Rb as M,Sa as n,Ta as _,Ua as k,Ub as D,Va as L,Wa as h,Xa as f,Xb as W,Ya as p,Yb as T,Z as v,_ as x,c as u,cb as N,cc as z,db as d,dc as O,eb as g,fb as C,ib as y,jb as I,kb as S,tb as E,ua as o,vb as R,wb as V,xb as A,ya as b}from"./chunk-BULBJQPZ.js";function ie(t,i){t&1&&(a(0,"div",5),_(1,"div",6),n())}function ae(t,i){if(t&1&&(a(0,"div",7),d(1),n()),t&2){let e=p();o(),g(e.error)}}function oe(t,i){if(t&1&&(a(0,"div",15)(1,"span",16),d(2),n(),a(3,"span",17),d(4),n(),a(5,"div",18)(6,"strong"),d(7,"Reason:"),n(),d(8),n(),a(9,"div",19),d(10),E(11,"date"),n()()),t&2){let e=p(3);o(2),C("Stage: ",e.rejection.stage,""),o(2),C("By: ",e.rejection.rejectedByName,""),o(4),C(" ",e.rejection.reason,""),o(2),g(R(11,4,e.rejection.rejectedAt,"medium"))}}function re(t,i){t&1&&(a(0,"div",20),d(1,"Rejection recorded but details unavailable."),n())}function de(t,i){if(t&1&&(a(0,"div",9)(1,"div",10),_(2,"i",11),a(3,"div")(4,"div",12),d(5,"Candidate Rejected"),n(),m(6,oe,12,7,"div",13)(7,re,2,0,"div",14),n()()()),t&2){let e=p(2);o(6),l("ngIf",e.rejection),o(),l("ngIf",!e.rejection)}}function le(t,i){if(t&1&&(a(0,"div",33),d(1),n()),t&2){let e=p().ngIf;o(),g(e.interviewerName)}}function se(t,i){if(t&1&&(a(0,"div",34),d(1),n()),t&2){let e=p().ngIf;o(),C("Rating: ",e.overallRating,"")}}function ce(t,i){if(t&1&&(k(0),m(1,le,2,1,"div",31)(2,se,2,1,"div",32),L()),t&2){let e=i.ngIf;o(),l("ngIf",e.interviewerName),o(),l("ngIf",e.isCompleted)}}function pe(t,i){t&1&&_(0,"div",35)}function me(t,i){if(t&1){let e=h();a(0,"div",23)(1,"div",24)(2,"span",25),d(3),n()(),a(4,"div",26)(5,"div",27),d(6),n(),a(7,"div",28),d(8),n(),m(9,ce,3,2,"ng-container",4),a(10,"div",15)(11,"button",29),f("click",function(){let s=v(e).$implicit,c=p(3);return x(c.reject(s))}),d(12,"Reject"),n()()(),m(13,pe,1,0,"div",30),n()}if(t&2){let e=i.$implicit,r=i.index,s=p(3);l("ngClass",s.status(e)),o(3),g(r+1),o(3),g(e.replace("-"," ")),o(),l("ngClass",s.status(e)),o(),g(s.status(e)),o(),l("ngIf",s.evalFor(e)),o(4),l("ngIf",r<s.stages.length-1)}}function ge(t,i){if(t&1&&(a(0,"div",21),m(1,me,14,7,"div",22),n()),t&2){let e=p(2);o(),l("ngForOf",e.stages)}}function _e(t,i){if(t&1&&(k(0),m(1,de,8,2,"div",8)(2,ge,2,1,"ng-template",null,0,A),L()),t&2){let e=N(3),r=p();o(),l("ngIf",(r.candidate==null?null:r.candidate.status)==="rejected")("ngIfElse",e)}}var P=class t{constructor(i){this.fs=i}candidateId;evaluations=[];candidate;rejection;loading=!1;error="";stages=["initial","system-task","technical","manager","hr"];InterviewStage=z;ngOnInit(){return u(this,null,function*(){this.candidateId&&(yield this.load())})}load(){return u(this,null,function*(){this.loading=!0,this.error="";try{if(this.candidate=yield this.fs.getCandidateById(this.candidateId),this.evaluations=yield this.fs.getCandidateEvaluationFlow(this.candidateId),this.candidate?.status==="rejected"){let i=yield this.fs.getRejectionsForCandidate(this.candidateId);this.rejection=i[0]}else this.rejection=null}catch(i){this.error=i.message||"Failed to load flow"}this.loading=!1})}evalFor(i){return this.evaluations.find(e=>e.stage===i)}status(i){let e=this.evalFor(i);return e?e.isCompleted?e.overallRating>=3?"passed":"failed":"in-progress":"pending"}reject(i){return u(this,null,function*(){let e=prompt("Reason for rejection?");if(e)try{yield this.fs.rejectCandidate(this.candidateId,i,e),yield this.load()}catch(r){this.error=r.message||"Failed to reject candidate"}})}static \u0275fac=function(e){return new(e||t)(b(O))};static \u0275cmp=w({type:t,selectors:[["app-candidate-flow"]],inputs:{candidateId:"candidateId"},decls:4,vars:3,consts:[["stagesView",""],[1,"candidate-flow"],["class","text-center py-3",4,"ngIf"],["class","alert alert-danger py-1 small",4,"ngIf"],[4,"ngIf"],[1,"text-center","py-3"],[1,"spinner-border","spinner-border-sm"],[1,"alert","alert-danger","py-1","small"],["class","alert alert-outline-danger border border-danger rounded small",4,"ngIf","ngIfElse"],[1,"alert","alert-outline-danger","border","border-danger","rounded","small"],[1,"d-flex","align-items-start","gap-2"],[1,"bi","bi-x-octagon-fill","text-danger","fs-5"],[1,"fw-semibold","text-danger"],["class","mt-1",4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"mt-1"],[1,"badge","bg-danger-subtle","text-danger","border","border-danger","me-2"],[1,"badge","bg-secondary-subtle","text-dark","border"],[1,"mt-2"],[1,"text-muted","mt-1",2,"font-size",".75rem"],[1,"text-muted"],[1,"flow-container"],["class","flow-stage",3,"ngClass",4,"ngFor","ngForOf"],[1,"flow-stage",3,"ngClass"],[1,"stage-circle"],[1,"abbr"],[1,"stage-body"],[1,"stage-name","text-capitalize"],[1,"stage-status","small",3,"ngClass"],["type","button",1,"btn","btn-outline-danger","btn-xs","btn-sm","py-0","px-1",3,"click"],["class","connector",4,"ngIf"],["class","small mt-1 text-muted",4,"ngIf"],["class","rating",4,"ngIf"],[1,"small","mt-1","text-muted"],[1,"rating"],[1,"connector"]],template:function(e,r){e&1&&(a(0,"div",1),m(1,ie,2,0,"div",2)(2,ae,2,1,"div",3)(3,_e,4,2,"ng-container",4),n()),e&2&&(o(),l("ngIf",r.loading),o(),l("ngIf",r.error),o(),l("ngIf",!r.loading&&!r.error))},dependencies:[T,B,F,M,D],styles:[".candidate-flow[_ngcontent-%COMP%]{font-size:.85rem}.flow-container[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1.25rem;overflow-x:auto;padding:.5rem .25rem}.flow-stage[_ngcontent-%COMP%]{position:relative;min-width:150px;padding:.75rem .75rem .75rem 0;display:flex;align-items:flex-start}.stage-circle[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;background:#e9ecef;display:flex;align-items:center;justify-content:center;font-weight:600;margin-right:.5rem;flex-shrink:0}.flow-stage.passed[_ngcontent-%COMP%]   .stage-circle[_ngcontent-%COMP%]{background:#198754;color:#fff}.flow-stage.failed[_ngcontent-%COMP%]   .stage-circle[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.flow-stage.in-progress[_ngcontent-%COMP%]   .stage-circle[_ngcontent-%COMP%]{background:#0d6efd;color:#fff}.flow-stage.pending[_ngcontent-%COMP%]   .stage-circle[_ngcontent-%COMP%]{background:#adb5bd;color:#fff}.stage-body[_ngcontent-%COMP%]{flex:1;min-width:0}.stage-name[_ngcontent-%COMP%]{font-weight:600;font-size:.8rem;line-height:1.1}.stage-status[_ngcontent-%COMP%]{font-size:.65rem;text-transform:uppercase;letter-spacing:.5px;font-weight:600;display:inline-block;padding:2px 6px;border-radius:12px;margin-top:2px;background:#f1f3f5;color:#495057}.stage-status.passed[_ngcontent-%COMP%]{background:#d1e7dd;color:#0f5132}.stage-status.failed[_ngcontent-%COMP%]{background:#f8d7da;color:#842029}.stage-status.in-progress[_ngcontent-%COMP%]{background:#cfe2ff;color:#084298}.stage-status.pending[_ngcontent-%COMP%]{background:#e2e3e5;color:#41464b}.connector[_ngcontent-%COMP%]{position:absolute;top:18px;left:calc(100% + .25rem);height:2px;width:60px;background:linear-gradient(to right,#adb5bd,#ced4da)}.rating[_ngcontent-%COMP%]{font-size:.7rem;margin-top:2px;font-weight:500}"]})};function fe(t,i){t&1&&_(0,"option",30)}function ue(t,i){if(t&1&&(a(0,"option",31),d(1),n()),t&2){let e=i.$implicit;l("value",e.position),o(),g(e.position)}}function Ce(t,i){t&1&&(a(0,"span"),d(1,"Refresh"),n())}function ve(t,i){t&1&&_(0,"span",32)}function xe(t,i){if(t&1&&(a(0,"div",33),d(1),n()),t&2){let e=p();o(),g(e.error)}}function be(t,i){if(t&1){let e=h();a(0,"tr",38),f("click",function(){let s=v(e).$implicit,c=p(2);return x(c.open(s))}),a(1,"td"),d(2),n(),a(3,"td",39),d(4),n(),a(5,"td"),d(6),n(),a(7,"td")(8,"span",40),d(9),n()(),a(10,"td")(11,"span",41),d(12),n()(),a(13,"td",42)(14,"button",43),f("click",function(s){let c=v(e).$implicit,j=p(2);return s.stopPropagation(),x(j.viewFlow(c))}),d(15,"Flow"),n(),a(16,"button",44),f("click",function(s){let c=v(e).$implicit,j=p(2);return s.stopPropagation(),x(j.startStage(c))}),d(17,"Continue"),n()()()}if(t&2){let e=i.$implicit;o(2),g(e.name),o(2),g(e.email),o(2),g(e.position),o(3),g(e.status),o(3),g(e.currentStage)}}function we(t,i){t&1&&(a(0,"tr")(1,"td",45),d(2,"No candidates found"),n()())}function he(t,i){if(t&1&&(a(0,"div",34)(1,"table",35)(2,"thead",36)(3,"tr")(4,"th"),d(5,"Name"),n(),a(6,"th"),d(7,"Email"),n(),a(8,"th"),d(9,"Position"),n(),a(10,"th"),d(11,"Status"),n(),a(12,"th"),d(13,"Stage"),n(),_(14,"th"),n()(),a(15,"tbody"),m(16,be,18,5,"tr",37)(17,we,3,0,"tr",15),n()()()),t&2){let e=p();o(16),l("ngForOf",e.filtered),o(),l("ngIf",e.filtered.length===0)}}function ye(t,i){t&1&&(a(0,"div",46),_(1,"div",47),n())}function Ie(t,i){if(t&1&&_(0,"app-candidate-flow",48),t&2){let e=p();l("candidateId",e.selectedCandidate.id)}}var X=class t{constructor(i,e,r){this.fs=i;this.router=e;this.toast=r}candidates=[];filtered=[];q="";statusFilter="";positionFilter="";loading=!1;error="";selectedCandidate=null;ngOnInit(){return u(this,null,function*(){yield this.load()})}load(){return u(this,null,function*(){this.loading=!0,this.error="";try{this.candidates=yield this.fs.getAllCandidates(),this.apply()}catch(i){this.error=i.message||"Failed to load",this.toast.error(this.error)}this.loading=!1})}apply(){let i=this.q.toLowerCase();this.filtered=this.candidates.filter(e=>(!this.statusFilter||e.status===this.statusFilter)&&(!this.positionFilter||e.position===this.positionFilter)&&(!i||e.name.toLowerCase().includes(i)||e.email.toLowerCase().includes(i)))}open(i){this.router.navigate(["/candidate",i.id,"report"])}startStage(i){let e=i.currentStage;this.router.navigate(["/evaluation",e,i.id])}viewFlow(i){return u(this,null,function*(){this.selectedCandidate=i;let e=document.getElementById("flowModal");if(e){let r=window.bootstrap?new window.bootstrap.Modal(e):null;r&&r.show()}})}static \u0275fac=function(e){return new(e||t)(b(O),b(q),b(U))};static \u0275cmp=w({type:t,selectors:[["app-candidate-list"]],decls:43,vars:17,consts:[[1,"container","py-4","candidate-list-wrapper"],[1,"d-flex","justify-content-between","align-items-center","mb-3","flex-wrap","gap-2"],[1,"mb-0"],[1,"d-flex","gap-2","flex-wrap"],["placeholder","Search",1,"form-control","form-control-sm",2,"width","200px",3,"ngModelChange","ngModel"],[1,"form-select","form-select-sm",2,"width","160px",3,"ngModelChange","change","ngModel"],["value",""],["value","applied"],["value","in-progress"],["value","hired"],["value","rejected"],["value","on-hold"],["disabled","","hidden","",4,"ngFor","ngForOf"],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-outline-secondary","btn-sm",3,"click","disabled"],[4,"ngIf"],["class","spinner-border spinner-border-sm",4,"ngIf"],["class","alert alert-danger py-2 small",4,"ngIf"],["class","table-responsive shadow-sm border rounded",4,"ngIf"],["class","text-center py-5",4,"ngIf"],["id","flowModal","tabindex","-1",1,"modal","fade"],[1,"modal-dialog","modal-lg","modal-dialog-scrollable"],[1,"modal-content"],[1,"modal-header","py-2"],[1,"modal-title"],["type","button","data-bs-dismiss","modal",1,"btn-close"],[1,"modal-body"],[3,"candidateId",4,"ngIf"],[1,"modal-footer","py-2"],["type","button","data-bs-dismiss","modal",1,"btn","btn-sm","btn-secondary"],["disabled","","hidden",""],[3,"value"],[1,"spinner-border","spinner-border-sm"],[1,"alert","alert-danger","py-2","small"],[1,"table-responsive","shadow-sm","border","rounded"],[1,"table","table-sm","table-hover","align-middle","mb-0"],[1,"table-light"],["style","cursor:pointer",3,"click",4,"ngFor","ngForOf"],[2,"cursor","pointer",3,"click"],[1,"text-muted","small"],[1,"badge","bg-secondary","text-uppercase","small"],[1,"badge","bg-info","text-dark","small"],[1,"text-end","d-flex","gap-1","justify-content-end"],[1,"btn","btn-outline-secondary","btn-sm",3,"click"],[1,"btn","btn-outline-primary","btn-sm",3,"click"],["colspan","6",1,"text-center","text-muted","small","py-4"],[1,"text-center","py-5"],[1,"spinner-border","text-primary"],[3,"candidateId"]],template:function(e,r){e&1&&(a(0,"div",0)(1,"div",1)(2,"h4",2),d(3,"Candidates"),n(),a(4,"div",3)(5,"input",4),S("ngModelChange",function(c){return I(r.q,c)||(r.q=c),c}),f("ngModelChange",function(){return r.apply()}),n(),a(6,"select",5),S("ngModelChange",function(c){return I(r.statusFilter,c)||(r.statusFilter=c),c}),f("change",function(){return r.apply()}),a(7,"option",6),d(8,"All Status"),n(),a(9,"option",7),d(10,"Applied"),n(),a(11,"option",8),d(12,"In Progress"),n(),a(13,"option",9),d(14,"Hired"),n(),a(15,"option",10),d(16,"Rejected"),n(),a(17,"option",11),d(18,"On Hold"),n()(),a(19,"select",5),S("ngModelChange",function(c){return I(r.positionFilter,c)||(r.positionFilter=c),c}),f("change",function(){return r.apply()}),a(20,"option",6),d(21,"All Positions"),n(),m(22,fe,1,0,"option",12),E(23,"slice"),m(24,ue,2,2,"option",13),n(),a(25,"button",14),f("click",function(){return r.load()}),m(26,Ce,2,0,"span",15)(27,ve,1,0,"span",16),n()()(),m(28,xe,2,1,"div",17)(29,he,18,2,"div",18)(30,ye,2,0,"div",19),n(),a(31,"div",20)(32,"div",21)(33,"div",22)(34,"div",23)(35,"h6",24),d(36),n(),_(37,"button",25),n(),a(38,"div",26),m(39,Ie,1,1,"app-candidate-flow",27),n(),a(40,"div",28)(41,"button",29),d(42,"Close"),n()()()()()),e&2&&(o(5),y("ngModel",r.q),o(),y("ngModel",r.statusFilter),o(13),y("ngModel",r.positionFilter),o(3),l("ngForOf",V(23,13,r.candidates,0,1)),o(2),l("ngForOf",r.candidates),o(),l("disabled",r.loading),o(),l("ngIf",!r.loading),o(),l("ngIf",r.loading),o(),l("ngIf",r.error),o(),l("ngIf",!r.loading),o(),l("ngIf",r.loading),o(6),C("Candidate Flow - ",r.selectedCandidate==null?null:r.selectedCandidate.name,""),o(3),l("ngIf",r.selectedCandidate))},dependencies:[T,F,M,W,Q,Y,$,H,K,G,J,P],styles:[".candidate-list-wrapper[_ngcontent-%COMP%]{max-width:1200px}"]})};export{X as CandidateListComponent};
