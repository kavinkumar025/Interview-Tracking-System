import{a as Q,b as U,c as s,d as M,e as O,f as G,g as R,h as P,i as H,j as $,k as j,l as W,m as B,n as Y,o as z,r as L,s as J,t as K}from"./chunk-46GCKG2T.js";import{h as q}from"./chunk-AHEKFUMX.js";import{Da as A,Ha as _,Oa as l,Pa as S,Pb as k,Qb as F,Ra as i,Rb as N,Sa as t,Ta as p,Wa as h,Xa as u,Ya as c,Yb as V,Z as g,_ as v,_a as C,a as T,c as b,db as o,dc as D,eb as f,fb as y,hb as w,mb as I,ua as a,ya as E}from"./chunk-BULBJQPZ.js";var ee=()=>["initial","systemTask","technical","manager","hr"];function te(n,r){n&1&&(i(0,"span"),o(1,"Refresh"),t())}function ie(n,r){n&1&&p(0,"span",18)}function ne(n,r){if(n&1&&(i(0,"div",19),o(1),t()),n&2){let e=c(2);a(),f(e.userError)}}function re(n,r){if(n&1){let e=h();i(0,"tr")(1,"td"),o(2),t(),i(3,"td",25),o(4),t(),i(5,"td")(6,"select",26),u("ngModelChange",function(d){let x=g(e).$implicit,Z=c(3);return v(Z.changeRole(x,d))}),i(7,"option",27),o(8,"Admin"),t(),i(9,"option",28),o(10,"HR"),t(),i(11,"option",29),o(12,"Interviewer"),t(),i(13,"option",30),o(14,"Manager"),t()()(),i(15,"td",31),o(16),t(),i(17,"td")(18,"span",32),o(19),t()(),i(20,"td")(21,"button",33),u("click",function(){let d=g(e).$implicit,x=c(3);return v(x.toggleActive(d))}),o(22),t()()()}if(n&2){let e=r.$implicit;a(2),f(e.name),a(2),f(e.email),a(2),l("ngModel",e.role),a(10),y("",e.canInterviewFor&&e.canInterviewFor.length?e.canInterviewFor.join(", "):"-"," "),a(2),S("bg-success",e.isActive)("bg-secondary",!e.isActive),a(),f(e.isActive?"Active":"Inactive"),a(2),l("ngClass",e.isActive?"btn-outline-warning":"btn-outline-success"),a(),y(" ",e.isActive?"Disable":"Enable"," ")}}function oe(n,r){n&1&&(i(0,"tr")(1,"td",34),o(2,"No users found."),t()())}function ae(n,r){if(n&1&&(i(0,"div",20)(1,"table",21)(2,"thead",22)(3,"tr")(4,"th"),o(5,"Name"),t(),i(6,"th"),o(7,"Email"),t(),i(8,"th"),o(9,"Role"),t(),i(10,"th"),o(11,"Stages"),t(),i(12,"th"),o(13,"Status"),t(),i(14,"th",23),o(15,"Actions"),t()()(),i(16,"tbody"),_(17,re,23,11,"tr",24)(18,oe,3,0,"tr",12),t()()()),n&2){let e=c(2);a(17),l("ngForOf",e.users),a(),l("ngIf",!e.users.length&&!e.loadingUsers)}}function le(n,r){n&1&&(i(0,"div",35),p(1,"div",36),t())}function se(n,r){if(n&1){let e=h();i(0,"div",9)(1,"div",10)(2,"strong"),o(3,"Users"),t(),i(4,"button",11),u("click",function(){g(e);let d=c();return v(d.loadUsers())}),_(5,te,2,0,"span",12)(6,ie,1,0,"span",13),t()(),i(7,"div",14),_(8,ne,2,1,"div",15)(9,ae,19,2,"div",16)(10,le,2,0,"div",17),t()()}if(n&2){let e=c();a(4),l("disabled",e.loadingUsers),a(),l("ngIf",!e.loadingUsers),a(),l("ngIf",e.loadingUsers),a(2),l("ngIf",e.userError),a(),l("ngIf",!e.userError),a(),l("ngIf",e.loadingUsers)}}function me(n,r){n&1&&(i(0,"span"),o(1,"Save"),t())}function de(n,r){n&1&&p(0,"span",18)}function ce(n,r){if(n&1&&(i(0,"div",58)(1,"label",59),o(2),t(),p(3,"input",60),t()),n&2){let e=r.$implicit;a(2),y("",e," %"),a(),l("formControlName",e)}}function pe(n,r){n&1&&(i(0,"div",61)(1,"div",62),o(2,"No custom questions."),t()())}function ue(n,r){if(n&1){let e=h();i(0,"div",63)(1,"div",64)(2,"div",65),p(3,"input",66),t(),i(4,"div",67),p(5,"input",68),t(),i(6,"div",69)(7,"select",70)(8,"option",71),o(9,"Rating"),t(),i(10,"option",72),o(11,"Text"),t(),i(12,"option",73),o(13,"Yes/No"),t(),i(14,"option",74),o(15,"Multi"),t()()(),i(16,"div",75),p(17,"input",76),t(),i(18,"div",77),p(19,"input",78),i(20,"label",79),o(21,"Req"),t()(),i(22,"div",80)(23,"button",81),u("click",function(){let d=g(e).index,x=c(2);return v(x.removeCustomQuestion(d))}),o(24,"\xD7"),t()()()()}if(n&2){let e=r.index;l("formGroupName",e),a(19),C("id","req",e,""),a(),C("for","req",e,"")}}function _e(n,r){n&1&&(i(0,"span"),o(1,"Refresh"),t())}function ge(n,r){n&1&&p(0,"span",18)}function ve(n,r){if(n&1&&(i(0,"div",19),o(1),t()),n&2){let e=c(2);a(),f(e.templateError)}}function fe(n,r){if(n&1){let e=h();i(0,"tr")(1,"td"),o(2),t(),i(3,"td",31),o(4),t(),i(5,"td",31),o(6),t(),i(7,"td")(8,"span",32),o(9),t()(),i(10,"td")(11,"div",84)(12,"button",85),u("click",function(){let d=g(e).$implicit,x=c(3);return v(x.editTemplate(d))}),o(13,"Edit"),t(),i(14,"button",86),u("click",function(){let d=g(e).$implicit,x=c(3);return v(x.deleteTemplate(d))}),o(15,"Del"),t()()()()}if(n&2){let e=r.$implicit;a(2),f(e.position),a(2),w("I:",e.weightings.initial," ST:",e.weightings.systemTask," T:",e.weightings.technical," M:",e.weightings.manager," HR:",e.weightings.hr,""),a(2),f(e.customQuestions&&e.customQuestions.length?e.customQuestions.length:0),a(2),S("bg-success",e.isActive)("bg-secondary",!e.isActive),a(),f(e.isActive?"Yes":"No")}}function xe(n,r){n&1&&(i(0,"tr")(1,"td",87),o(2,"No templates"),t()())}function be(n,r){if(n&1&&(i(0,"div",20)(1,"table",82)(2,"thead",22)(3,"tr")(4,"th"),o(5,"Position"),t(),i(6,"th"),o(7,"Weights"),t(),i(8,"th"),o(9,"Questions"),t(),i(10,"th"),o(11,"Active"),t(),i(12,"th",83),o(13,"Actions"),t()()(),i(14,"tbody"),_(15,fe,16,12,"tr",24)(16,xe,3,0,"tr",12),t()()()),n&2){let e=c(2);a(15),l("ngForOf",e.templates),a(),l("ngIf",!e.templates.length&&!e.loadingTemplates)}}function he(n,r){n&1&&(i(0,"div",35),p(1,"div",36),t())}function Se(n,r){if(n&1){let e=h();i(0,"div",37)(1,"div",38)(2,"div",39)(3,"div",10)(4,"strong"),o(5),t(),i(6,"div")(7,"button",40),u("click",function(){g(e);let d=c();return v(d.newTemplate())}),o(8,"New"),t(),i(9,"button",41),u("click",function(){g(e);let d=c();return v(d.saveTemplate())}),_(10,me,2,0,"span",12)(11,de,1,0,"span",13),t()()(),i(12,"div",42)(13,"form",43)(14,"div",44)(15,"label",45),o(16,"Position"),t(),p(17,"input",46),t(),i(18,"div",47),_(19,ce,4,2,"div",48),t(),p(20,"hr"),i(21,"div",49)(22,"strong",50),o(23,"Custom Questions"),t(),i(24,"button",51),u("click",function(){g(e);let d=c();return v(d.addCustomQuestion())}),o(25,"Add"),t()(),_(26,pe,3,0,"div",52),i(27,"div",53),_(28,ue,25,5,"div",54),t()()()()(),i(29,"div",55)(30,"div",56)(31,"div",10)(32,"strong"),o(33,"Templates"),t(),i(34,"button",11),u("click",function(){g(e);let d=c();return v(d.loadTemplates())}),_(35,_e,2,0,"span",12)(36,ge,1,0,"span",13),t()(),i(37,"div",57),_(38,ve,2,1,"div",15)(39,be,17,2,"div",16)(40,he,2,0,"div",17),t()()()()}if(n&2){let e=c();a(5),f(e.editingTemplate?"Edit Template":"New Template"),a(4),l("disabled",e.savingTemplate||e.templateForm.invalid),a(),l("ngIf",!e.savingTemplate),a(),l("ngIf",e.savingTemplate),a(2),l("formGroup",e.templateForm),a(6),l("ngForOf",I(14,ee)),a(7),l("ngIf",!e.customQuestionsArray().length),a(2),l("ngForOf",e.customQuestionsArray().controls),a(6),l("disabled",e.loadingTemplates),a(),l("ngIf",!e.loadingTemplates),a(),l("ngIf",e.loadingTemplates),a(2),l("ngIf",e.templateError),a(),l("ngIf",!e.templateError),a(),l("ngIf",e.loadingTemplates)}}function ye(n,r){n&1&&(i(0,"span"),o(1,"Save Settings"),t())}function Ee(n,r){n&1&&p(0,"span",18)}function Ce(n,r){if(n&1){let e=h();i(0,"div",88)(1,"div",89)(2,"strong"),o(3,"Notification Settings"),t()(),i(4,"div",42)(5,"form",90)(6,"div",91)(7,"label",45),o(8,"Reminder Days Before"),t(),p(9,"input",92),t(),i(10,"div",91)(11,"label",45),o(12,"Digest Hour (0-23)"),t(),p(13,"input",93),t(),i(14,"div",94)(15,"div",95),p(16,"input",96),i(17,"label",97),o(18,"Send Daily Digest"),t()()(),i(19,"div",98)(20,"button",99),u("click",function(){g(e);let d=c();return v(d.saveNotifications())}),_(21,ye,2,0,"span",12)(22,Ee,1,0,"span",13),t()()(),i(23,"p",100),o(24,"(Stub) Persist to Firestore settings collection in future."),t()()()}if(n&2){let e=c();a(5),l("formGroup",e.notificationForm),a(15),l("disabled",e.savingNotifications),a(),l("ngIf",!e.savingNotifications),a(),l("ngIf",e.savingNotifications)}}var X=class n{constructor(r,e){this.fb=r;this.fs=e}tab="users";users=[];loadingUsers=!1;userError=null;templates=[];loadingTemplates=!1;templateError=null;templateForm;notificationForm;savingTemplate=!1;savingNotifications=!1;editingTemplate=null;ngOnInit(){this.buildForms(),this.loadUsers(),this.loadTemplates()}buildForms(){this.templateForm=this.fb.group({position:["",s.required],stageWeightings:this.fb.group({initial:[15,[s.required,s.min(0)]],systemTask:[20,[s.required,s.min(0)]],technical:[25,[s.required,s.min(0)]],managerial:[20,[s.required,s.min(0)]],hr:[20,[s.required,s.min(0)]]}),customQuestions:this.fb.array([])}),this.notificationForm=this.fb.group({reminderDays:[3,[s.required,s.min(1)]],sendDailyDigest:[!0],digestHour:[8,[s.required,s.min(0),s.max(23)]]})}loadUsers(){return b(this,null,function*(){this.loadingUsers=!0,this.userError=null;try{this.users=yield this.fs.getAllUsers()}catch(r){this.userError=r.message||"Failed to load users"}finally{this.loadingUsers=!1}})}changeRole(r,e){return b(this,null,function*(){let m=typeof e=="string"?e:e.target.value;r.role!==m&&(yield this.fs.updateUser(r.id,{role:m}),r.role=m)})}toggleActive(r){return b(this,null,function*(){yield this.fs.updateUser(r.id,{isActive:!r.isActive}),r.isActive=!r.isActive})}customQuestionsArray(){return this.templateForm.get("customQuestions")}addCustomQuestion(){this.customQuestionsArray().push(this.fb.group({key:["",s.required],question:["",s.required],maxScore:[5,[s.required,s.min(1)]]}))}removeCustomQuestion(r){this.customQuestionsArray().removeAt(r)}loadTemplates(){return b(this,null,function*(){this.loadingTemplates=!0,this.templateError=null;try{this.templates=yield this.fs.getEvaluationTemplates()}catch(r){this.templateError=r.message||"Failed to load templates"}finally{this.loadingTemplates=!1}})}editTemplate(r){this.editingTemplate=r,this.templateForm.patchValue({position:r.position,stageWeightings:r.weightings}),this.customQuestionsArray().clear(),(r.customQuestions||[]).forEach(e=>this.customQuestionsArray().push(this.fb.group({id:[e.id,s.required],question:[e.question,s.required],type:[e.type,s.required],weightage:[e.weightage,[s.required,s.min(0)]],required:[e.required]}))),this.tab="templates"}newTemplate(){this.editingTemplate=null,this.templateForm.reset({position:"",stageWeightings:{initial:15,systemTask:20,technical:25,managerial:20,hr:20}}),this.customQuestionsArray().clear(),this.tab="templates"}saveTemplate(){return b(this,null,function*(){if(this.templateForm.invalid){this.templateForm.markAllAsTouched();return}this.savingTemplate=!0;try{let r=this.templateForm.value;if(this.editingTemplate)yield this.fs.updateEvaluationTemplate(this.editingTemplate.id,r),Object.assign(this.editingTemplate,r);else{let e=yield this.fs.createEvaluationTemplate(r);this.templates.push(T({id:e},r))}this.newTemplate(),yield this.loadTemplates()}finally{this.savingTemplate=!1}})}deleteTemplate(r){return b(this,null,function*(){r.id&&confirm("Delete template?")&&(yield this.fs.deleteEvaluationTemplate(r.id),this.templates=this.templates.filter(e=>e.id!==r.id))})}saveNotifications(){return b(this,null,function*(){if(this.notificationForm.invalid){this.notificationForm.markAllAsTouched();return}this.savingNotifications=!0,setTimeout(()=>this.savingNotifications=!1,600)})}static \u0275fac=function(e){return new(e||n)(E(L),E(D))};static \u0275cmp=A({type:n,selectors:[["app-admin-settings"]],decls:17,vars:9,consts:[[1,"container","py-4","admin-settings-wrapper"],[1,"d-flex","align-items-center","mb-3"],[1,"mb-0","me-3"],[1,"nav","nav-pills","small"],[1,"nav-item"],[1,"nav-link",3,"click"],["class","card shadow-sm mb-4",4,"ngIf"],["class","row g-3",4,"ngIf"],["class","card shadow-sm",4,"ngIf"],[1,"card","shadow-sm","mb-4"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"btn","btn-sm","btn-outline-secondary",3,"click","disabled"],[4,"ngIf"],["class","spinner-border spinner-border-sm",4,"ngIf"],[1,"card-body","p-0"],["class","alert alert-danger m-3",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","p-3 text-center",4,"ngIf"],[1,"spinner-border","spinner-border-sm"],[1,"alert","alert-danger","m-3"],[1,"table-responsive"],[1,"table","table-sm","table-hover","mb-0","align-middle"],[1,"table-light"],[2,"width","160px"],[4,"ngFor","ngForOf"],[1,"text-muted","small"],[1,"form-select","form-select-sm",3,"ngModelChange","ngModel"],["value","admin"],["value","hr"],["value","interviewer"],["value","manager"],[1,"small"],[1,"badge"],[1,"btn","btn-sm",3,"click","ngClass"],["colspan","6",1,"text-center","text-muted","py-3","small"],[1,"p-3","text-center"],[1,"spinner-border"],[1,"row","g-3"],[1,"col-lg-5"],[1,"card","shadow-sm","h-100"],[1,"btn","btn-sm","btn-outline-secondary","me-2",3,"click"],[1,"btn","btn-sm","btn-primary",3,"click","disabled"],[1,"card-body"],[1,"small",3,"formGroup"],[1,"mb-2"],[1,"form-label"],["type","text","formControlName","position","placeholder","e.g. Senior Developer",1,"form-control"],[1,"row","g-2"],["class","col-6",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"small","mb-0"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"click"],["class","border rounded p-2",4,"ngIf"],["formArrayName","customQuestions"],["class","custom-q-item mb-2 p-2 border rounded",3,"formGroupName",4,"ngFor","ngForOf"],[1,"col-lg-7"],[1,"card","shadow-sm","h-100","d-flex","flex-column"],[1,"card-body","p-0","flex-grow-1"],[1,"col-6"],[1,"form-label","text-capitalize"],["type","number",1,"form-control","form-control-sm",3,"formControlName"],[1,"border","rounded","p-2"],[1,"text-muted","text-center","small"],[1,"custom-q-item","mb-2","p-2","border","rounded",3,"formGroupName"],[1,"row","g-1","align-items-center"],[1,"col-4"],["formControlName","id","placeholder","key",1,"form-control","form-control-sm"],[1,"col-8"],["formControlName","question","placeholder","Question",1,"form-control","form-control-sm"],[1,"col-5","mt-1"],["formControlName","type",1,"form-select","form-select-sm"],["value","rating"],["value","text"],["value","boolean"],["value","multiple-choice"],[1,"col-4","mt-1"],["type","number","formControlName","weightage","placeholder","Weight",1,"form-control","form-control-sm"],[1,"col-2","mt-1","form-check"],["type","checkbox","formControlName","required",1,"form-check-input",3,"id"],[1,"form-check-label","small",3,"for"],[1,"col-1","text-end","mt-1"],["type","button",1,"btn","btn-outline-danger","btn-sm",3,"click"],[1,"table","table-sm","table-striped","align-middle","mb-0"],[2,"width","140px"],[1,"btn-group","btn-group-sm"],[1,"btn","btn-outline-primary",3,"click"],[1,"btn","btn-outline-danger",3,"click"],["colspan","5",1,"text-center","text-muted","py-3","small"],[1,"card","shadow-sm"],[1,"card-header"],[1,"row","g-3","small",3,"formGroup"],[1,"col-md-4"],["type","number","formControlName","reminderDays",1,"form-control"],["type","number","formControlName","digestHour",1,"form-control"],[1,"col-md-4","d-flex","align-items-end"],[1,"form-check"],["type","checkbox","formControlName","sendDailyDigest","id","digestChk",1,"form-check-input"],["for","digestChk",1,"form-check-label"],[1,"col-12"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"text-muted","small","mt-3","mb-0"]],template:function(e,m){e&1&&(i(0,"div",0)(1,"div",1)(2,"h4",2),o(3,"Admin Settings"),t(),i(4,"ul",3)(5,"li",4)(6,"button",5),u("click",function(){return m.tab="users"}),o(7,"Users"),t()(),i(8,"li",4)(9,"button",5),u("click",function(){return m.tab="templates"}),o(10,"Evaluation Templates"),t()(),i(11,"li",4)(12,"button",5),u("click",function(){return m.tab="notifications"}),o(13,"Notifications"),t()()()(),_(14,se,11,6,"div",6)(15,Se,41,15,"div",7)(16,Ce,25,4,"div",8),t()),e&2&&(a(6),S("active",m.tab==="users"),a(3),S("active",m.tab==="templates"),a(3),S("active",m.tab==="notifications"),a(2),l("ngIf",m.tab==="users"),a(),l("ngIf",m.tab==="templates"),a(),l("ngIf",m.tab==="notifications"))},dependencies:[V,k,F,N,K,R,Y,z,U,P,Q,B,M,O,H,W,$,j,J,G,q],styles:[".admin-settings-wrapper[_ngcontent-%COMP%]{max-width:1000px}"]})};export{X as AdminSettingsComponent};
